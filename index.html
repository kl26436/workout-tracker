<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Big Surf - Workout Tracker</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css"
    />
    <style>
      body {
        background-color: #0d1117;
        color: #c9d1d9;
      }
      .exercise-card {
        padding: 1rem;
        margin-bottom: 2rem;
        border: 1px solid #30363d;
        border-radius: 8px;
        background-color: #161b22;
      }
      .completed {
        border-color: #238636;
      }
      textarea {
        width: 100%;
        margin-top: 0.5rem;
        resize: vertical;
      }
      table input {
        width: 4rem;
      }
    </style>
  </head>
  <body>
    <nav class="container-fluid">
      <ul>
        <li><strong>Big Surf</strong></li>
      </ul>
      <ul>
        <li><a href="#">Log Workout</a></li>
        <li><a href="#">Progress</a></li>
      </ul>
    </nav>

    <header class="container" style="text-align:center; margin-top: 2rem;">
      <img
        src="BigSurf.png"
        alt="Big Surf Logo"
        style="max-width: 100%; height: auto;"
      />
    </header>

    <main class="container">
      <div class="grid">
        <section>
          <hgroup>
            <h2>Big Surf Tracker</h2>
            <h3>Choose Your Day</h3>
          </hgroup>

          <label for="daySelect">Workout Day</label>
          <select id="daySelect">
            <option>Monday</option>
            <option>Tuesday</option>
            <option>Wednesday</option>
            <option>Thursday</option>
            <option>Friday</option>
            <option>Saturday</option>
          </select>

          <div id="workout-list"></div>
        </section>
      </div>
    </main>

    <footer class="container">
      <small><a href="#">Privacy</a> â€¢ <a href="#">Terms</a></small>
    </footer>

    <script>
      let workouts = [];
      const workoutList = document.getElementById("workout-list");
      const daySelect = document.getElementById("daySelect");

      const todayDate = new Date().toISOString().split("T")[0];
      const currentWeekday = new Date().toLocaleString("en-US", {
        weekday: "long",
      });

      daySelect.value = currentWeekday;

      fetch("workouts.json")
        .then((res) => res.json())
        .then((data) => {
          workouts = data;
          loadWorkoutForDay(currentWeekday);
        });

      daySelect.addEventListener("change", () => {
        const selectedDay = daySelect.value;
        loadWorkoutForDay(selectedDay);
      });

      function loadWorkoutForDay(day) {
        workoutList.innerHTML = "";
        const storageKey = `workout_${todayDate}_${day}`;
        const savedData = JSON.parse(localStorage.getItem(storageKey) || "{}");

        const workout = workouts.find((w) => w.day === day);
        if (!workout) {
          workoutList.innerHTML = `<p>No workout scheduled for ${day}.</p>`;
          return;
        }

        workout.exercises.forEach((exercise) => {
          const card = document.createElement("div");
          card.className = "exercise-card";

          const header = document.createElement("h3");
          header.textContent = exercise.machine;

          const videoLink = document.createElement("a");
          videoLink.href = exercise.video;
          videoLink.target = "_blank";
          videoLink.textContent = "Watch Form Video";

          const table = document.createElement("table");
          const headerRow = document.createElement("tr");
          headerRow.innerHTML =
            "<th>Set</th><th>Reps</th><th>Weight (lbs)</th>";
          table.appendChild(headerRow);

          const inputRows = [];

          for (let i = 1; i <= exercise.sets; i++) {
            const row = document.createElement("tr");

            const setCell = document.createElement("td");
            setCell.textContent = `Set ${i}`;

            const repsCell = document.createElement("td");
            const repsInput = document.createElement("input");
            repsInput.type = "number";
            repsInput.min = 0;
            repsInput.placeholder = exercise.reps;

            const weightCell = document.createElement("td");
            const weightInput = document.createElement("input");
            weightInput.type = "number";
            weightInput.min = 0;
            weightInput.placeholder = exercise.weight;

            const savedSets = savedData[exercise.machine];
            if (savedSets && savedSets[i - 1]) {
              repsInput.value = savedSets[i - 1].reps;
              weightInput.value = savedSets[i - 1].weight;
            }

            inputRows.push({ repsInput, weightInput });

            repsCell.appendChild(repsInput);
            weightCell.appendChild(weightInput);
            row.appendChild(setCell);
            row.appendChild(repsCell);
            row.appendChild(weightCell);
            table.appendChild(row);
          }

          const notes = document.createElement("textarea");
          notes.placeholder = "Notes...";

          const toggle = document.createElement("button");
          toggle.textContent = "Mark as Complete";
          toggle.onclick = () => {
            const log = JSON.parse(localStorage.getItem(storageKey) || "{}");
            const setsData = inputRows.map(({ repsInput, weightInput }) => ({
              reps: repsInput.value,
              weight: weightInput.value,
            }));
            log[exercise.machine] = setsData;
            localStorage.setItem(storageKey, JSON.stringify(log));
            card.classList.add("completed");
            toggle.textContent = "Saved!";
          };

          card.appendChild(header);
          card.appendChild(videoLink);
          card.appendChild(table);
          card.appendChild(notes);
          card.appendChild(toggle);
          workoutList.appendChild(card);
        });
      }
    </script>
  </body>
</html>
